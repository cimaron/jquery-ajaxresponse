function XMLHttpRequestStub(){"use strict";var t;this._requestHeaders=[],this._responseHeaders=[],this._mime="",this._data=null,this._events={},this._settings={method:"",url:"",async:!0,user:"",password:"",data:""};for(t in XMLHttpRequestStub._defaultProps)XMLHttpRequestStub._defaultProps.hasOwnProperty(t)&&(this[t]=XMLHttpRequestStub._defaultProps[t])}function XMLHttpResponse(){"use strict";this._events={},this.xhr=new XMLHttpRequestStub,this.xhr.on("open",function(){this.trigger("open",[this,arguments])}.bind(this)),this.xhr.on("send",function(){this.trigger("send",[this,this.xhr._settings])}.bind(this))}XMLHttpRequestStub._defaultProps={onreadystatechange:function(){},readyState:0,response:null,responseText:null,responseType:"",responseXML:null,status:0,statusText:"",timeout:0,ontimeout:function(){},upload:function(){},withCredentials:!1},XMLHttpRequestStub.prototype={abort:function(){},getAllResponseHeaders:function(){var t,e="";if(this.readyState<2)return null;for(t in this._responseHeaders)this._responseHeaders.hasOwnProperty(t)&&(e+=t+": "+this._responseHeaders[t]+"\r\n");return e},getResponseHeader:function(t){return this.readyState<2?null:this._responseHeaders[t]},open:function(t,e,s,n,i){this.readyState=1,this._settings.method=t,this._settings.url=e,void 0!==s&&(this._settings.async=s),void 0!==n&&(this._settings.user=n),void 0!==i&&(this._settings.password=i),this.trigger("open",[t,e,s,n,i]),this.onreadystatechange()},overrideMimeType:function(t){this.readyState<2&&(this._mime=t)},send:function(t){this._settings.data=t,this._settings.async?setTimeout(function(){this.trigger("send")}.bind(this),0):this.trigger("send")},setRequestHeader:function(t,e){this._requestHeaders[t]=e},on:function(t,e){var s;return"function"==typeof e&&(s=this._events[t]||[],s.push(e),this._events[t]=s),this},trigger:function(t,e){var s,n;for(s=this._events[t]||[],n=0;n<s.length;n++)s[n].apply(this,e||[])}},XMLHttpResponse.prototype={timeout:function(){this.xhr.timeout>0?setTimeout(function(){this.xhr.ontimeout()},this.xhr.timeout):this.xhr.ontimeout()},status:function(t,e){if(1!==this.xhr.readyState)throw new Error("Request not in a state to accept status ("+this.xhr.readyState+")");this.xhr.status=t,this.xhr.statusText=e},header:function(t,e){if(1!==this.xhr.readyState)throw new Error("Request not in a state to accept headers ("+this.xhr.readyState+")");this.xhr.status||this.status(200,"OK"),null===e&&(t=t.split(": ",2),e=t[1],t=t[0]),this.xhr._responseHeaders[t]=e},body:function(t){1==this.xhr.readyState&&(this.xhr.status||this.status(200,"OK"),null===this.xhr.getResponseHeader("Content-Type")&&this.header("Content-Type","text/text"),this.xhr.readyState=2),null===this.xhr.responseText?this.xhr.responseText=t:this.xhr.responseText+=t,2==this.xhr.readyState&&(this.xhr.readyState=3)},close:function(){1==this.xhr.status&&(this.status(200,"OK"),this.body("")),this.xhr.readyState=4,this.xhr.onreadystatechange()},wait:function(t,e){var s=this;setTimeout(function(){e(s)},t)},on:function(t,e){var s;return"function"==typeof e&&(s=this._events[t]||[],s.push(e),this._events[t]=s),this},trigger:function(t,e){var s,n;for(s=this._events[t]||[],n=0;n<s.length;n++)s[n].apply(this,e||[])}},function(t){"use strict";function e(){var t,e;if(t=i.shift(),void 0===t&&!o)throw new Error("No response registered for request");return e=new XMLHttpResponse,e.on("open",function(){t&&t.open?t.open.apply(this,arguments):r.trigger("open",arguments)}),e.on("send",function(){t&&t.send?t.send.apply(this,arguments):r.trigger("send",arguments)}),e.xhr}var s,n=t.ajaxSettings.xhr,i=[],r=t({}),o=!1;s={enqueue:function(t,e){i.push({open:t,send:e})},start:function(){t.ajaxSettings.xhr=e},open:function(t){r.on("open",function(e,s,n){t.apply(s,[s,n])}),o=!0},send:function(t){r.on("send",function(e,s,n){t.apply(s,[s,n])}),o=!0},stop:function(){t.ajaxSettings.xhr=n}},t.ajaxResponse=function(t,e,n){switch(t){case"start":return void s.start();case"stop":return void s.stop();case"onOpen":return void("function"==typeof e&&s.open(e));case"onSend":return void("function"==typeof e&&s.send(e));case"enqueue":return void("function"==typeof n?s.enqueue(e,n):s.enqueue(null,e));default:"function"==typeof t&&"function"==typeof e?(s.open(e),s.send(extra1)):"function"==typeof t&&s.send(e)}}}(jQuery);